<!DOCTYPE html>

<html>
<head>
        <meta charset="utf-8">
        <title>MyConnectome Data Browser</title>

        <link rel="stylesheet" media="all" href="//maxcdn.bootstrapcdn.com/bootstrap/3.3.2/css/bootstrap.min.css" /> 
        <link rel="stylesheet" media="all" href="//cdn.datatables.net/plug-ins/1.10.7/integration/bootstrap/3/dataTables.bootstrap.css" />
        <script src='//code.jquery.com/jquery-1.11.1.min.js'></script>
        <script type='text/javascript' src='//cdn.datatables.net/1.10.7/js/jquery.dataTables.min.js'></script>
        <script src='//cdn.datatables.net/plug-ins/1.10.7/integration/bootstrap/3/dataTables.bootstrap.js'></script>
        <!--<script src="{{ url_for('static',filename='range_numbers.js')}}"></script>-->

        {% include 'header.html' %} 
        {% include 'dropdown.html' %} 
</head>

<body class="background">

{% include 'navigation.html' %}

<div class='wrapper'>
{% include 'banner.html' %}

<script>
// Function to filter columns
//$.fn.dataTable.ext.search.push(
//    function( settings, data, dataIndex ) {
//        var min = parseFloat($('#min').val());
//        var max = parseFloat($('#max').val());
//        var qval = parseFloat( data[5] ) || 0; // qvalue column
// 
//        if ( ( isNaN( min ) && isNaN( max ) ) ||
//             ( isNaN( min ) && qval <= max ) ||
//            ( min <= qval   && isNaN( max ) ) ||
//             ( min <= qval   && qval <= max ) )
//        {
//            return true;
//        }
//        return false;
//    }
//);


$(document).ready(function() {
   var tabley = $('#tabley').dataTable();

    // User can set min and max of pvalue
    //$('#min', '#max').keyup( function() {
    //    tabley.draw();
    //} );
} );

</script>

<body>
<div class="row">
    <div class="col-md-2" style="z-index:5;margin-right:80px">
            <div id="wrapper">
                <nav id="main_nav" style='margin-top:50px'>
                    <ul>
                        <li>
                            <a href="">SELECT THE FIRST VARIABLE</a>
                            <ul>
                                {% for category,subcategory in dropdown.iteritems() %}
                                <li><a href="">{{ lookup[category] }}</a>
                                <ul>
                                    <li style="background-color:#4F92AF"><a href="#">SELECT THE SECOND VARIABLE</a></li>
                                    {% for item in subcategory %}
                                    <!-- Note - if deployed in subdirectory of server, you must hard code path here-->
                                    <li><a href="/explore/{{ category }}/{{ item }}">{{ lookup[item] }}</a></li>
                                    {% endfor %}
                                </ul>
                                </li>
                                {% endfor %}
                           </ul>
                       </li>
                   </ul>
               </nav>
          </div>
    </div><!--end column-->
    {% if table is defined %}
   <div class="col-md-8" style="margin-left: 50px;margin-top: 100px;">

       <!--Filter based on qvalue
        <tbody><tr>
            <td>min:</td>
            <td><input type="text" id="min" name="min"></td>
        </tr>
        <tr>
            <td>max:</td>
            <td><input type="text" id="max" name="max"></td>
        </tr>
    </tbody></table>-->
       
       <table id="tabley" class="table table-striped table-bordered" cellspacing="0" width="100%"> 
           <thead>
               <tr>
                   <th>x variable</th>
                   <th>y variable</th>
                   <th type="number"  title="Pearson correlation between variables">correlation</th>
                   <th title="t value obtained from regressing X on Y variable in an ARIMA model">T (arima)</th>
                   <th type="number" style="width:130px">number obs.</th>
                   <th type="number" title="False discovery rate obtained using Benjamini-Hochberg procedure">qvalue</th>
               </tr>
           </thead>
           <tbody>
              {% for xvar, yvar, corval, tarima, tdrift, nobs, pval in table %}
              <tr>
                  <td>{{ xvar }}</td>
                  <td>{{ yvar }}</td>
                  <td>{{ corval }}</td>
                  <td>{{ tarima }}</td>
                  <td>{{ nobs }}</td>
                  <td>{{ pval }}</td>
              </tr>
              {% endfor %}
           </tbody>
        </table>
    </div><!-- end column-->
    {% endif %}
    </div><!-- end row-->
</div>
</div>
<script>
// Dynamic banner
var width = 1600,
    height = 100

var svg = d3.select("#banner").append("svg")
    .attr("width", width)
    .attr("height", height)

// the data will be appended here
raw = {"letters":[{{ letters|safe }}],
       "colors":[{{ colors|safe }}],
       "x":[{{ xcoords|safe }}],
       "y":[{{ ycoords|safe }}]};

data = []
for (i = 0; i < raw.letters.length; i++) { 
  data.push({"letter":raw.letters[i],"color":raw.colors[i],"x":+raw.x[i],"y":+raw.y[i]});
}

var text = svg.selectAll("text")
    .data(data)
    .enter()
    .append("text");

var textLabels = text
    .attr("x", function(d,i) { return d.x; })
    .attr("y", function(d,i) { return d.y + 30; })
    .style("fill",function(d){ return d.color })
    .style("font-family","'Roboto Condensed', sans-serif")
    .text( function (d) { return d.letter })
    .on('mouseover.color', function(d) {
        d3.select(this).style("fill", "#2997ab");
     })

</script>
</body>
{% include 'footer.html' %}
</html>
